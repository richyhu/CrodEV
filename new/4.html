
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CrodEV - æ™ºèƒ½èŠå¤©åŠ©æ‰‹</title>
    <link rel="icon" href="https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/super_tool/791e3d3f67804a64ad4a5851285e424b~tplv-a9rns2rl98-image.image?rcl=20251214050547624A69F50984C157D8AB&rk3s=8e244e95&rrcfp=f06b921b&x-expires=1768251980&x-signature=FMYVOhOE8nqzDdTeMzD1ogMOGMY%3D">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- KaTeXæ”¯æŒ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/mhchem.min.js"></script>
    <!-- highlight.jsæ”¯æŒ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Gemini é£æ ¼é…è‰²
                        'gemini-bg': '#131314',
                        'gemini-surface': '#1E1F20',
                        'gemini-hover': '#2D2E35',
                        'gemini-border': '#444746',
                        'gemini-primary': '#A8C7FA',
                        'gemini-accent': '#8AB4F8',
                        'gemini-text': '#E3E3E3',
                        'gemini-muted': '#9CA3AF',
                        // ä¿ç•™åŸæœ‰é¢œè‰²å˜é‡ä½œä¸ºåˆ«å
                        primary: '#A8C7FA',
                        secondary: '#8AB4F8',
                        accent: '#A8C7FA',
                        'deep-bg': '#131314',
                        'side-bg': '#1E1F20',
                        'main-bg': '#131314',
                        'card-bg': '#1E1F20',
                        'hover-bg': '#2D2E35',
                        'border-color': '#444746',
                        'text-primary': '#E3E3E3',
                        'text-secondary': '#C5C5C5',
                        'text-muted': '#9CA3AF',
                        'success': '#10b981',
                        'warning': '#f59e0b',
                        'danger': '#ef4444',
                    },
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.3s ease-out',
                        'slide-up': 'slideUp 0.3s ease-out',
                        'pulse-slow': 'pulse 2s infinite',
                        'bounce-slow': 'bounce 1.5s infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                    },
                    borderRadius: {
                        'gemini': '20px',
                        'gemini-lg': '24px',
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .scrollbar-thin {
                scrollbar-width: thin;
            }
            .glass-effect {
                backdrop-filter: blur(12px);
                -webkit-backdrop-filter: blur(12px);
            }
        }
    </style>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #131314;
            color: #E3E3E3;
            overflow-x: hidden;
        }
        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ - Gemini é£æ ¼ */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: #444746;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #5F6368;
        }
        /* ç»ç’ƒæ€æ•ˆæœ - Gemini é£æ ¼ */
        .glass-card {
            background: rgba(30, 31, 32, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(68, 71, 70, 0.5);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }
        /* æ¸å˜è¾¹æ¡†æ•ˆæœ - Gemini é£æ ¼ */
        .gradient-border {
            position: relative;
        }
        .gradient-border::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: inherit;
            padding: 1px;
            background: linear-gradient(135deg, #A8C7FA, #8AB4F8);
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            opacity: 0.3;
            transition: opacity 0.3s ease;
        }
        .gradient-border:hover::before {
            opacity: 0.6;
        }
        /* Markdown å†…å®¹æ ·å¼ */
        .markdown-content {
            letter-spacing: -0.01em;
            line-height: 1.7;
        }
        .markdown-content h1,
        .markdown-content h2,
        .markdown-content h3 {
            color: #E3E3E3;
            font-weight: 600;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }
        .markdown-content h1 {
            font-size: 1.75rem;
            border-bottom: 1px solid #444746;
            padding-bottom: 0.75rem;
        }
        .markdown-content h2 {
            font-size: 1.5rem;
        }
        .markdown-content h3 {
            font-size: 1.25rem;
        }
        .markdown-content p {
            margin-bottom: 1rem;
            color: #C5C5C5;
        }
        /* ä»£ç å—æ ·å¼ - Gemini é£æ ¼ */
        .markdown-content pre {
            background: #1E1F20;
            padding: 1.5rem;
            border-radius: 16px;
            overflow-x: auto;
            margin-bottom: 1.5rem;
            border: 1px solid #444746;
            position: relative;
            padding-top: 3rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        .markdown-content code {
            font-family: 'Fira Code', 'Consolas', monospace;
            background: rgba(168, 199, 250, 0.1);
            padding: 0.25rem 0.5rem;
            border-radius: 6px;
            font-size: 0.875rem;
            color: #A8C7FA;
        }
        .markdown-content pre code {
            background: transparent;
            padding: 0;
            font-size: 0.85rem;
            color: #E3E3E3;
            white-space: pre;
            display: block;
        }
        .language-label {
            position: absolute;
            top: 0;
            left: 0;
            padding: 0.5rem 1rem;
            background: #A8C7FA;
            color: #131314;
            font-size: 0.75rem;
            font-weight: 600;
            border-top-left-radius: 16px;
            border-bottom-right-radius: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .copy-button {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.375rem;
            padding: 0.5rem 0.875rem;
            background: rgba(168, 199, 250, 0.15);
            color: #A8C7FA;
            border: 1px solid rgba(168, 199, 250, 0.3);
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .copy-button:hover {
            background: rgba(168, 199, 250, 0.25);
            color: #fff;
            transform: translateY(-1px);
        }
        .copy-button.copied {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
            border-color: rgba(16, 185, 129, 0.5);
        }
        .markdown-content blockquote {
            border-left: 4px solid #A8C7FA;
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            background: rgba(168, 199, 250, 0.08);
            border-radius: 0 12px 12px 0;
            color: #C5C5C5;
            font-style: italic;
        }
        .markdown-content ul,
        .markdown-content ol {
            padding-left: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .markdown-content ul li,
        .markdown-content ol li {
            margin-bottom: 0.5rem;
            color: #C5C5C5;
        }
        .markdown-content ul {
            list-style-type: disc;
        }
        .markdown-content ol {
            list-style-type: decimal;
        }
        .markdown-content a {
            color: #A8C7FA;
            text-decoration: underline;
        }
        .markdown-content a:hover {
            color: #8AB4F8;
        }
        /* æ¶ˆæ¯æ°”æ³¡ - Gemini é£æ ¼ */
        .message-bubble {
            transition: all 0.2s ease;
        }
        .message-bubble:hover {
            transform: translateY(-1px);
        }
        .user-message {
            background: rgba(168, 199, 250, 0.12);
            border: 1px solid rgba(168, 199, 250, 0.25);
            border-radius: 20px;
        }
        .assistant-message {
            background: rgba(30, 31, 32, 0.8);
            border: 1px solid rgba(68, 71, 70, 0.5);
            border-radius: 20px;
        }
        /* æŒ‰é’®æ ·å¼ - Gemini é£æ ¼ */
        .btn-primary {
            background: linear-gradient(135deg, #A8C7FA 0%, #8AB4F8 100%);
            color: #131314;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(168, 199, 250, 0.3);
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(168, 199, 250, 0.4);
        }
        .btn-secondary {
            background: rgba(68, 71, 70, 0.5);
            color: #E3E3E3;
            border: 1px solid rgba(68, 71, 70, 0.8);
            transition: all 0.2s ease;
        }
        .btn-secondary:hover {
            background: rgba(68, 71, 70, 0.7);
            border-color: rgba(168, 199, 250, 0.5);
        }
        /* è¾“å…¥æ¡†ç„¦ç‚¹æ•ˆæœ - Gemini é£æ ¼ */
        .input-focus:focus {
            border-color: #A8C7FA;
            box-shadow: 0 0 0 3px rgba(168, 199, 250, 0.15);
            outline: none;
        }
        /* æ¨¡å‹é€‰æ‹©å™¨æ ·å¼ */
        .model-select {
            background: rgba(30, 31, 32, 0.8);
            border: 1px solid rgba(68, 71, 70, 0.5);
            transition: all 0.2s ease;
        }
        .model-select:hover {
            border-color: rgba(168, 199, 250, 0.5);
        }
        .model-select:focus {
            border-color: #A8C7FA;
            box-shadow: 0 0 0 3px rgba(168, 199, 250, 0.15);
            outline: none;
        }
        /* ä¾§è¾¹æ æ ·å¼ - Gemini é£æ ¼ */
        #sidebar {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 30;
            background: #1E1F20;
        }
        #sidebar.collapsed {
            width: 72px !important;
        }
        #sidebar.collapsed .sidebar-text {
            display: none !important;
        }
        #sidebar.collapsed .sidebar-icon {
            margin: 0 auto;
        }
        .sidebar-toggle {
            transition: transform 0.3s ease;
        }
        #sidebar.collapsed .sidebar-toggle {
            transform: rotate(180deg);
        }
        /* æ‰“å­—åŠ¨ç”» */
        .typing-dot {
            animation: typingBounce 1.4s infinite ease-in-out both;
            background: #A8C7FA;
        }
        .typing-dot:nth-child(1) {
            animation-delay: -0.32s;
        }
        .typing-dot:nth-child(2) {
            animation-delay: -0.16s;
        }
        @keyframes typingBounce {
            0%, 80%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% {
                transform: scale(1.2);
                opacity: 1;
            }
        }
        /* æ¨¡æ€æ¡†æ ·å¼ */
        .modal-backdrop {
            background: rgba(19, 19, 20, 0.92);
        }
        /* å“åº”å¼ */
        @media (max-width: 768px) {
            #sidebar {
                position: fixed;
                left: -280px;
                top: 0;
                bottom: 0;
                width: 280px !important;
                border-radius: 0 20px 20px 0;
                margin: 0;
            }
            #sidebar.active {
                left: 0;
            }
            #sidebar.collapsed.active {
                width: 72px !important;
            }
            .sidebar-overlay {
                position: fixed;
                inset: 0;
                background: rgba(0, 0, 0, 0.7);
                z-index: 29;
                opacity: 0;
                pointer-events: none;
                transition: opacity 0.3s ease;
            }
            .sidebar-overlay.active {
                opacity: 1;
                pointer-events: auto;
            }
        }
        @media (min-width: 768px) {
            #sidebar:not(.collapsed) {
                width: 280px !important;
            }
        }
        /* æ·±åº¦æ€è€ƒæ ‡ç­¾æ ·å¼ - Gemini é£æ ¼ */
        .think-tag {
            background: rgba(168, 199, 250, 0.08);
            border: 1px solid rgba(168, 199, 250, 0.2);
            border-radius: 16px;
            padding: 1rem 1.25rem;
            margin-bottom: 1rem;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        .think-tag:hover {
            background: rgba(168, 199, 250, 0.12);
            border-color: rgba(168, 199, 250, 0.3);
            transform: translateY(-1px);
        }
        .think-tag::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, #A8C7FA, #8AB4F8);
            opacity: 0.6;
        }
        .think-tag-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            color: #A8C7FA;
            font-size: 0.875rem;
            font-weight: 600;
        }
        .think-tag-header i {
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .think-tag-content {
            color: #C5C5C5;
            font-size: 0.9375rem;
            line-height: 1.6;
            letter-spacing: -0.005em;
        }
        /* è¡¨æ ¼æ ·å¼ - Gemini é£æ ¼ */
        .markdown-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            table-layout: auto;
        }
        .markdown-content th {
            background-color: rgba(168, 199, 250, 0.15);
            color: #E3E3E3;
            font-weight: 600;
            text-align: center;
            padding: 0.875rem 1rem;
            border-bottom: 1px solid rgba(68, 71, 70, 0.5);
            border-right: 1px solid rgba(68, 71, 70, 0.3);
            white-space: nowrap;
        }
        .markdown-content th:last-child {
            border-right: none;
        }
        .markdown-content td {
            padding: 0.875rem 1rem;
            border-bottom: 1px solid rgba(68, 71, 70, 0.3);
            border-right: 1px solid rgba(68, 71, 70, 0.2);
            color: #C5C5C5;
            text-align: left;
            vertical-align: top;
            white-space: normal;
            word-break: break-word;
        }
        .markdown-content td:last-child {
            border-right: none;
        }
        .markdown-content td:first-child {
            text-align: center;
            white-space: nowrap;
            font-weight: 500;
        }
        .markdown-content tr:last-child td {
            border-bottom: none;
        }
        .markdown-content tr:hover td {
            background-color: rgba(68, 71, 70, 0.15);
        }
        .markdown-content tr:nth-child(even) td {
            background-color: rgba(68, 71, 70, 0.05);
        }
        .markdown-content tr:nth-child(even):hover td {
            background-color: rgba(68, 71, 70, 0.2);
        }
        /* æ•°å­¦å…¬å¼æ ·å¼ */
        .katex {
            font-size: 1.1em;
        }
        .katex-display {
            margin: 1em 0;
        }
        /* å“åº”å¼è¡¨æ ¼ */
        @media (max-width: 768px) {
            .markdown-content table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
        }
        /* çŠ¶æ€å¾½ç«  - Gemini é£æ ¼ */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        .status-badge.free {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        .status-badge.premium {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }
        .status-badge.reasoner {
            background: rgba(168, 199, 250, 0.2);
            color: #A8C7FA;
        }
    </style>
</head>
<body class="min-h-screen font-inter overflow-hidden">
    <!-- Cookie åŒæ„å¼¹çª— -->
    <div id="cookieModal"
        class="fixed inset-0 z-50 flex items-center justify-center p-4 opacity-0 pointer-events-none transition-opacity duration-300 modal-backdrop">
        <div class="glass-card max-w-md w-full rounded-gemini-lg p-6 transform transition-transform duration-300 scale-95">
            <div class="text-center mb-6">
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-gemini bg-gradient-to-br from-gemini-primary/20 to-gemini-accent/20 mb-4">
                    <i class="fa-solid fa-cookie-bite text-gemini-primary text-2xl"></i>
                </div>
                <h3 class="text-xl font-bold mb-2 text-text-primary">å…³äºç½‘ç«™ä½¿ç”¨çš„Cookie</h3>
                <p class="text-text-secondary text-sm">æˆ‘ä»¬ä½¿ç”¨Cookieæ¥æå‡æ‚¨çš„ä½“éªŒå¹¶ç¡®ä¿ç½‘ç«™æ­£å¸¸è¿è¡Œã€‚ç»§ç»­ä½¿ç”¨å³è¡¨ç¤ºæ‚¨åŒæ„æˆ‘ä»¬ä½¿ç”¨Cookieã€‚</p>
            </div>
            <div class="flex flex-col sm:flex-row gap-3">
                <button id="acceptCookies" class="btn-primary py-3 px-6 rounded-xl font-medium flex-1">
                    <i class="fa-solid fa-check mr-2"></i>æ¥å—
                </button>
                <button id="declineCookies" class="btn-secondary py-3 px-6 rounded-xl font-medium flex-1">
                    <i class="fa-solid fa-times mr-2"></i>æ‹’ç»
                </button>
            </div>
        </div>
    </div>
    <!-- ç™»å½•/æ³¨å†Œæ¨¡æ€æ¡† -->
    <div id="authModal"
        class="fixed inset-0 z-40 flex items-center justify-center p-4 opacity-0 pointer-events-none transition-opacity duration-300 modal-backdrop">
        <div class="glass-card max-w-md w-full rounded-gemini-lg p-6 transform transition-transform duration-300 scale-95">
            <div class="text-center mb-6">
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-gemini bg-gradient-to-br from-gemini-primary/20 to-gemini-accent/20 mb-4">
                    <i class="fa-solid fa-user-shield text-gemini-primary text-2xl"></i>
                </div>
                <h3 id="authModalTitle" class="text-xl font-bold mb-2 text-text-primary">ç™»å½• CrodEV</h3>
                <p id="authModalSubtitle" class="text-text-secondary text-sm">è¯·è¾“å…¥æ‚¨çš„é‚®ç®±å’Œå¯†ç ä»¥ç»§ç»­</p>
            </div>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-text-secondary mb-2">é‚®ç®±</label>
                    <input type="email" id="emailInput" placeholder="your@email.com" class="w-full bg-card-bg border border-border-color rounded-xl px-4 py-3 text-text-primary focus:outline-none input-focus transition-all duration-300">
                </div>
                <div>
                    <label class="block text-sm font-medium text-text-secondary mb-2">å¯†ç </label>
                    <div class="relative">
                        <input type="password" id="passwordInput" placeholder="è¾“å…¥å¯†ç " class="w-full bg-card-bg border border-border-color rounded-xl px-4 py-3 pr-12 text-text-primary focus:outline-none input-focus transition-all duration-300">
                        <button id="togglePassword" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-text-muted hover:text-text-primary transition-colors">
                            <i class="fa-solid fa-eye-slash"></i>
                        </button>
                    </div>
                </div>
                <p id="authErrorMsg" class="text-danger text-sm hidden">
                    <i class="fa-solid fa-exclamation-circle mr-1"></i>ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•</p>
                <button id="submitAuth" class="btn-primary py-3 px-6 rounded-xl font-medium w-full">
                    <i class="fa-solid fa-sign-in-alt mr-2"></i>ç™»å½•
                </button>
                <div class="text-center">
                    <button id="toggleAuthMode" class="text-gemini-primary hover:text-gemini-accent text-sm transition-colors font-medium">
                        è¿˜æ²¡æœ‰è´¦å·ï¼Ÿç«‹å³æ³¨å†Œ
                    </button>
                </div>
            </div>
        </div>
    </div>
<!-- APIè®¾ç½®çª—å£ -->
<div id="apiSettingsModal"
    class="fixed inset-0 z-40 flex items-center justify-center p-4 opacity-0 pointer-events-none transition-opacity duration-300 modal-backdrop">
    <div class="glass-card max-w-lg w-full rounded-gemini-lg p-6 transform transition-transform duration-300 scale-95 max-h-[90vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-6">
            <div>
                <h3 class="text-xl font-bold text-text-primary">API è®¾ç½®</h3>
                <p class="text-text-muted text-sm mt-1">ä¸ºæ¯ä¸ªæ¨¡å‹é…ç½®ç‹¬ç«‹çš„APIå¯†é’¥</p>
            </div>
            <button id="closeApiSettings" class="w-10 h-10 flex items-center justify-center rounded-xl text-text-muted hover:text-text-primary hover:bg-hover-bg transition-all">
                <i class="fa-solid fa-times text-lg"></i>
            </button>
        </div>
        <div class="space-y-4">
            <div>
                <label class="block text-sm font-medium text-text-secondary mb-2">é€‰æ‹©æ¨¡å‹</label>
                <select id="apiModelSelect" class="w-full model-select rounded-xl px-4 py-3 text-text-primary focus:outline-none transition-all duration-300">
                    <optgroup label="ğŸ”® DeepSeek ç³»åˆ—">
                        <option value="deepseek-chat">DeepSeek Chat</option>
                        <option value="deepseek-reasoner">DeepSeek Reasoner âš¡</option>
                    </optgroup>
                    <optgroup label="ğŸŒŸ Qwen ç³»åˆ—">
                        <option value="qwen3-8b">Qwen3-8B</option>
                        <option value="qwen2.5-7b-instruct">Qwen2.5-7B-Instruct</option>
                        <option value="qwen2.5-coder-7b-instruct">Qwen2.5-Coder-7B ğŸ’»</option>
                        <option value="qwen2-7b-instruct">Qwen2-7B-Instruct</option>
                    </optgroup>
                    <optgroup label="ğŸ¯ GLM ç³»åˆ—">
                        <option value="glm-z1-9b-0414">GLM-Z1-9B âš¡</option>
                        <option value="glm-4-9b-chat">GLM-4-9B-Chat</option>
                        <option value="glm-4-9b-0414">GLM-4-9B-0414</option>
                    </optgroup>
                    <optgroup label="ğŸ“š InternLM ç³»åˆ—">
                        <option value="internlm2_5-7b-chat">InternLM2.5-7B-Chat</option>
                    </optgroup>
                </select>
            </div>
            <div>
                <label class="block text-sm font-medium text-text-secondary mb-2">API Key</label>
                <div class="relative">
                    <input type="text" id="apiKeyInput" placeholder="è¾“å…¥API Key" class="w-full bg-card-bg border border-border-color rounded-xl px-4 py-3 pr-12 text-text-primary focus:outline-none input-focus transition-all duration-300 font-mono text-sm">
                    <button id="toggleApiKey" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-text-muted hover:text-text-primary transition-colors">
                        <i class="fa-solid fa-eye-slash"></i>
                    </button>
                </div>
            </div>
            <div class="flex gap-3">
                <button id="saveApiKey" class="btn-primary py-3 px-6 rounded-xl font-medium flex-1">
                    <i class="fa-solid fa-save mr-2"></i>ä¿å­˜
                </button>
                <button id="resetApiKey" class="btn-secondary py-3 px-6 rounded-xl font-medium flex-1">
                    <i class="fa-solid fa-undo mr-2"></i>æ¢å¤é»˜è®¤
                </button>
            </div>
            <p id="apiKeyStatus" class="text-sm hidden"></p>
        </div>
    </div>
</div>
<!-- è‡ªå®šä¹‰æ³¨é”€ç¡®è®¤æ¨¡æ€æ¡† -->
<div id="deleteAccountModal"
    class="fixed inset-0 z-50 flex items-center justify-center p-4 opacity-0 pointer-events-none transition-opacity duration-300 modal-backdrop">
    <div class="glass-card max-w-md w-full rounded-gemini-lg p-6 transform transition-transform duration-300 scale-95">
        <!-- ç¬¬ä¸€æ­¥ç¡®è®¤ -->
        <div id="deleteStep1">
            <div class="text-center mb-6">
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-gemini bg-danger/20 mb-4">
                    <i class="fa-solid fa-exclamation-triangle text-danger text-2xl"></i>
                </div>
                <h3 class="text-xl font-bold mb-2 text-danger">âš ï¸ è­¦å‘Š</h3>
                <p class="text-text-secondary">æ³¨é”€è´¦æˆ·å°†æ°¸ä¹…åˆ é™¤æ‚¨çš„æ‰€æœ‰æ•°æ®ï¼Œæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚</p>
            </div>
            <div class="flex gap-3">
                <button id="deleteStep1Cancel" class="btn-secondary py-3 px-6 rounded-xl font-medium flex-1">å–æ¶ˆ</button>
                <button id="deleteStep1Continue" class="bg-danger hover:bg-danger/90 text-white py-3 px-6 rounded-xl font-medium flex-1 transition-colors">ç»§ç»­</button>
            </div>
        </div>
        <!-- ç¬¬äºŒæ­¥ç¡®è®¤ -->
        <div id="deleteStep2" class="hidden">
            <div class="text-center mb-6">
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-gemini bg-danger/20 mb-4">
                    <i class="fa-solid fa-exclamation-circle text-danger text-2xl"></i>
                </div>
                <h3 class="text-xl font-bold mb-2 text-danger">âš ï¸ å†æ¬¡ç¡®è®¤</h3>
                <p class="text-text-secondary">æ­¤æ“ä½œå°†æ— æ³•æ¢å¤ï¼æ‰€æœ‰èŠå¤©è®°å½•å’Œä¸ªäººè®¾ç½®å°†è¢«æ°¸ä¹…åˆ é™¤ã€‚</p>
            </div>
            <div class="flex gap-3">
                <button id="deleteStep2Cancel" class="btn-secondary py-3 px-6 rounded-xl font-medium flex-1">è¿”å›</button>
                <button id="deleteStep2Continue" class="bg-danger hover:bg-danger/90 text-white py-3 px-6 rounded-xl font-medium flex-1 transition-colors">ç»§ç»­</button>
            </div>
        </div>
        <!-- ç¬¬ä¸‰æ­¥ç¡®è®¤ -->
        <div id="deleteStep3" class="hidden">
            <div class="text-center mb-6">
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-gemini bg-danger/20 mb-4">
                    <i class="fa-solid fa-user-slash text-danger text-2xl"></i>
                </div>
                <h3 class="text-xl font-bold mb-2 text-danger">âš ï¸ æœ€åç¡®è®¤</h3>
                <p class="text-text-secondary mb-4">è¯·ç‚¹å‡»"ç¡®è®¤æ³¨é”€"ä»¥å®Œæˆæ“ä½œï¼Œæ‚¨çš„æ‰€æœ‰æ•°æ®å°†è¢«æ°¸ä¹…åˆ é™¤ï¼</p>
            </div>
            <div class="flex gap-3">
                <button id="deleteStep3Cancel" class="btn-secondary py-3 px-6 rounded-xl font-medium flex-1">è¿”å›</button>
                <button id="deleteStep3Confirm" class="bg-danger hover:bg-danger/90 text-white py-3 px-6 rounded-xl font-medium flex-1 transition-colors">ç¡®è®¤æ³¨é”€</button>
            </div>
        </div>
        <!-- æ³¨é”€æˆåŠŸæç¤º -->
        <div id="deleteSuccess" class="hidden">
            <div class="text-center mb-6">
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-gemini bg-success/20 mb-4">
                    <i class="fa-solid fa-check-circle text-success text-2xl"></i>
                </div>
                <h3 class="text-xl font-bold mb-2 text-text-primary">æ“ä½œå®Œæˆ</h3>
                <p class="text-text-secondary">æ‚¨çš„è´¦æˆ·å·²è¢«æ³¨é”€ï¼Œæ‰€æœ‰æ•°æ®å·²è¢«æ°¸ä¹…åˆ é™¤ã€‚</p>
            </div>
            <button id="deleteSuccessClose" class="btn-primary w-full py-3 px-6 rounded-xl font-medium">ç¡®å®š</button>
        </div>
    </div>
</div>
<!-- ä¾§è¾¹æ è¦†ç›–å±‚ -->
<div id="sidebarOverlay" class="sidebar-overlay"></div>
<!-- ä¸»ç•Œé¢å®¹å™¨ -->
<div id="appContainer" class="h-screen flex flex-col md:flex-row">
    <!-- ä¾§è¾¹æ å¯¼èˆª - Gemini é£æ ¼ -->
    <aside id="sidebar"
        class="w-72 md:w-72 h-screen flex flex-col border-r border-border-color/50 z-30 md:ml-3 md:mt-3 md:mb-3 md:rounded-gemini-lg overflow-hidden">
        <!-- å“ç‰Œæ ‡å¿— -->
        <div class="flex items-center justify-between p-4 border-b border-border-color/30">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-gemini-primary to-gemini-accent flex items-center justify-center shadow-lg">
                    <i class="fa-solid fa-robot text-gemini-bg text-lg"></i>
                </div>
                <h1 class="text-xl font-bold text-text-primary sidebar-text">CrodEV</h1>
            </div>
            <button class="sidebar-toggle w-8 h-8 flex items-center justify-center rounded-lg text-text-muted hover:text-text-primary hover:bg-hover-bg transition-all">
                <i class="fa-solid fa-angle-left sidebar-toggle-icon"></i>
            </button>
        </div>
        <!-- æ–°å»ºå¯¹è¯æŒ‰é’® -->
        <div class="p-3">
            <button id="newChatButton" class="flex items-center justify-center gap-3 w-full px-4 py-3 rounded-xl btn-primary font-medium">
                <i class="fa-solid fa-plus text-lg sidebar-icon"></i>
                <span class="sidebar-text">æ–°å»ºå¯¹è¯</span>
            </button>
        </div>
        <!-- å¯¼èˆªèœå• -->
        <nav class="flex-1 overflow-y-auto scrollbar-thin py-2">
            <ul class="space-y-1 px-3">
                <li>
                    <a href="#"
                        class="flex items-center gap-3 px-4 py-3 rounded-xl bg-gemini-primary/10 text-gemini-primary border border-gemini-primary/20">
                        <i class="fa-solid fa-home text-lg sidebar-icon"></i>
                        <span class="sidebar-text">ä¸»é¡µ</span>
                    </a>
                </li>
                <li>
                    <a href="#"
                        class="flex items-center gap-3 px-4 py-3 rounded-xl text-text-secondary hover:bg-hover-bg hover:text-text-primary transition-all">
                        <i class="fa-solid fa-history text-lg sidebar-icon"></i>
                        <span class="sidebar-text">å†å²è®°å½•</span>
                    </a>
                </li>
            </ul>
            <!-- å†å²è®°å½•åˆ—è¡¨ -->
            <div class="mt-4 px-3">
                <h3 class="text-xs uppercase text-text-muted px-4 mb-2 sidebar-text tracking-wider">æœ€è¿‘å¯¹è¯</h3>
                <ul id="historyList" class="space-y-1"></ul>
            </div>
        </nav>
        <!-- åº•éƒ¨ç”¨æˆ·èœå• -->
        <div class="mt-auto p-3 border-t border-border-color/30">
            <div class="relative">
                <div class="flex items-center gap-3 px-3 py-3 rounded-xl bg-card-bg/50 hover:bg-hover-bg cursor-pointer transition-all"
                    id="userMenuTrigger">
                    <div class="w-10 h-10 rounded-full bg-gradient-to-br from-gemini-primary to-gemini-accent flex items-center justify-center shadow-md">
                        <i class="fa-solid fa-user text-gemini-bg"></i>
                    </div>
                    <div class="flex-1 sidebar-text">
                        <div id="usernameDisplay" class="text-text-primary text-sm font-medium">ç”¨æˆ·</div>
                        <div class="text-text-muted text-xs flex items-center gap-1">
                            <span class="w-2 h-2 rounded-full bg-success"></span>
                            å·²ç™»å½•
                        </div>
                    </div>
                    <i class="fa-solid fa-chevron-up text-xs text-text-muted sidebar-text"></i>
                </div>
                <!-- ç”¨æˆ·ä¸‹æ‹‰èœå• -->
                <div id="userMenuDropdown"
                    class="fixed inset-0 flex items-center justify-center z-50 opacity-0 pointer-events-none modal-backdrop">
                    <div class="glass-card border border-border-color/50 rounded-gemini-lg w-80 max-w-[90%] overflow-hidden shadow-2xl">
                        <div class="p-4 border-b border-border-color/30 bg-card-bg/50">
                            <h3 class="text-lg font-semibold text-text-primary">è´¦æˆ·é€‰é¡¹</h3>
                        </div>
                        <div class="py-2">
                            <button id="logoutButton" class="w-full text-left px-4 py-3 hover:bg-hover-bg text-text-primary flex items-center gap-3 transition-colors">
                                <i class="fa-solid fa-sign-out-alt text-text-muted"></i>
                                <span>ç™»å‡ºè´¦æˆ·</span>
                            </button>
                            <div class="border-t border-border-color/30 my-2"></div>
                            <div class="px-4 py-2">
                                <span class="text-danger text-xs font-medium flex items-center gap-1">
                                    <i class="fa-solid fa-exclamation-triangle"></i>
                                    å±é™©åŒºåŸŸ
                                </span>
                            </div>
                            <button id="deleteAccountButton" class="w-full text-left px-4 py-3 text-danger hover:bg-danger/10 flex items-center gap-3 transition-colors">
                                <i class="fa-solid fa-user-slash"></i>
                                <span>æ³¨é”€è´¦æˆ·</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </aside>
    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <main class="flex-1 flex flex-col h-screen overflow-hidden">
        <!-- é¡¶éƒ¨å¯¼èˆªæ  - Gemini é£æ ¼ -->
        <header class="h-16 flex items-center justify-between px-4 sm:px-6 bg-gemini-bg/80 glass-effect border-b border-border-color/30">
            <div class="flex items-center gap-4">
                <button id="mobileMenuButton" class="md:hidden w-10 h-10 flex items-center justify-center rounded-xl text-text-secondary hover:text-gemini-primary hover:bg-hover-bg transition-all">
                    <i class="fa-solid fa-bars text-lg"></i>
                </button>
                <button id="desktopSidebarToggle" class="hidden md:flex items-center gap-2 btn-secondary px-3 py-2 rounded-lg text-sm">
                    <i class="fa-solid fa-chevron-left"></i>
                    <span>éšè—èœå•</span>
                </button>
                <!-- æ¨¡å‹é€‰æ‹©å™¨ -->
                <div class="flex items-center gap-2">
                    <span class="text-text-muted text-sm hidden sm:inline">æ¨¡å‹:</span>
                    <div class="relative">
                        <select id="modelSelect" class="model-select rounded-xl pl-4 pr-10 py-2 text-text-primary text-sm focus:outline-none appearance-none cursor-pointer min-w-[180px]">
                            <optgroup label="ğŸ”® DeepSeek">
                                <option value="deepseek-chat">DeepSeek Chat</option>
                                <option value="deepseek-reasoner">DeepSeek Reasoner âš¡</option>
                            </optgroup>
                            <optgroup label="ğŸŒŸ Qwen">
                                <option value="qwen3-8b" selected>Qwen3-8B</option>
                                <option value="qwen2.5-7b-instruct">Qwen2.5-7B</option>
                                <option value="qwen2.5-coder-7b-instruct">Qwen2.5-Coder ğŸ’»</option>
                                <option value="qwen2-7b-instruct">Qwen2-7B</option>
                            </optgroup>
                            <optgroup label="ğŸ¯ GLM">
                                <option value="glm-z1-9b-0414">GLM-Z1-9B âš¡</option>
                                <option value="glm-4-9b-chat">GLM-4-9B-Chat</option>
                                <option value="glm-4-9b-0414">GLM-4-9B-0414</option>
                            </optgroup>
                            <optgroup label="ğŸ“š InternLM">
                                <option value="internlm2_5-7b-chat">InternLM2.5-7B</option>
                            </optgroup>
                        </select>
                        <i class="fa-solid fa-chevron-down absolute right-3 top-1/2 transform -translate-y-1/2 text-text-muted text-xs pointer-events-none"></i>
                    </div>
                </div>
            </div>
            <div class="flex items-center gap-2">
                <!-- å½“å‰æ¨¡å‹çŠ¶æ€ -->
                <div id="modelStatus"
                    class="hidden sm:flex items-center gap-2 px-3 py-1.5 rounded-lg bg-card-bg/50 border border-border-color/30">
                    <span class="w-2 h-2 rounded-full bg-success animate-pulse"></span>
                    <span class="text-xs text-text-muted">å°±ç»ª</span>
                </div>
                <button id="openApiSettings" class="w-10 h-10 flex items-center justify-center rounded-xl bg-card-bg/50 border border-border-color/30 text-text-secondary hover:text-gemini-primary hover:border-gemini-primary/50 transition-all">
                    <i class="fa-solid fa-sliders"></i>
                </button>
            </div>
        </header>
        <!-- èŠå¤©åŒºåŸŸ -->
        <div id="chatBox" class="flex-1 overflow-y-auto scrollbar-thin p-4 sm:p-6">
            <!-- æ¬¢è¿æ¶ˆæ¯ -->
            <div class="max-w-3xl mx-auto mb-8">
                <div class="glass-card rounded-gemini-lg p-6 gradient-border">
                    <div class="flex items-center gap-4 mb-4">
                        <div class="w-14 h-14 rounded-gemini bg-gradient-to-br from-gemini-primary to-gemini-accent flex items-center justify-center shadow-lg">
                            <i class="fa-solid fa-sparkles text-gemini-bg text-xl"></i>
                        </div>
                        <div>
                            <h2 class="text-2xl font-bold text-text-primary">æ¬¢è¿ä½¿ç”¨ CrodEV</h2>
                            <p class="text-text-muted text-sm">æ™ºèƒ½å¯¹è¯ï¼Œæ— é™å¯èƒ½</p>
                        </div>
                    </div>
                    <p class="text-text-secondary mb-5">æˆ‘æ˜¯æ‚¨çš„ AI åŠ©æ‰‹,æ”¯æŒå¤šç§å¤§è¯­è¨€æ¨¡å‹ã€‚å¯ä»¥å¸®åŠ©æ‚¨è§£å†³é—®é¢˜ã€å›ç­”ç–‘é—®ã€ç¼–å†™ä»£ç æˆ–è¿›è¡Œåˆ›æ„è®¨è®ºã€‚</p>
                    <div class="grid gap-2">
                        <button class="w-full text-left glass-card hover:bg-hover-bg p-4 rounded-xl text-text-primary transition-all group">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-xl bg-gemini-primary/20 flex items-center justify-center group-hover:bg-gemini-primary/30 transition-colors">
                                    <i class="fa-solid fa-code text-gemini-primary"></i>
                                </div>
                                <div>
                                    <div class="font-medium">ç¼–å†™ä»£ç </div>
                                    <div class="text-text-muted text-sm">å¦‚ä½•ç¼–å†™ä¸€ä¸ªç®€å•çš„ Python è„šæœ¬ï¼Ÿ</div>
                                </div>
                            </div>
                        </button>
                        <button class="w-full text-left glass-card hover:bg-hover-bg p-4 rounded-xl text-text-primary transition-all group">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-xl bg-gemini-accent/20 flex items-center justify-center group-hover:bg-gemini-accent/30 transition-colors">
                                    <i class="fa-solid fa-lightbulb text-gemini-accent"></i>
                                </div>
                                <div>
                                    <div class="font-medium">åˆ›æ„çµæ„Ÿ</div>
                                    <div class="text-text-muted text-sm">ä¸ºæˆ‘çš„æ–°é¡¹ç›®æä¾›ä¸€äº›åˆ›æ„æƒ³æ³•</div>
                                </div>
                            </div>
                        </button>
                        <button class="w-full text-left glass-card hover:bg-hover-bg p-4 rounded-xl text-text-primary transition-all group">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-xl bg-warning/20 flex items-center justify-center group-hover:bg-warning/30 transition-colors">
                                    <i class="fa-solid fa-language text-warning"></i>
                                </div>
                                <div>
                                    <div class="font-medium">ç¿»è¯‘æ–‡æœ¬</div>
                                    <div class="text-text-muted text-sm">å¸®æˆ‘ç¿»è¯‘ä¸€æ®µä¸­è‹±æ–‡æ–‡å­—</div>
                                </div>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
            <!-- AIæ¬¢è¿æ¶ˆæ¯ -->
            <div class="flex items-start gap-4 mb-6 max-w-3xl mx-auto animate-fade-in">
                <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-gemini-primary to-gemini-accent flex items-center justify-center flex-shrink-0 shadow-lg">
                    <i class="fa-solid fa-robot text-gemini-bg text-sm"></i>
                </div>
                <div class="assistant-message rounded-gemini rounded-tl-sm p-4 max-w-[85%]">
                    <p class="text-text-primary leading-relaxed">æ‚¨å¥½ï¼æˆ‘æ˜¯ CrodEVï¼Œå¾ˆé«˜å…´ä¸ºæ‚¨æœåŠ¡ã€‚æˆ‘å¯ä»¥å¸®åŠ©æ‚¨è§£å†³é—®é¢˜ã€ç”Ÿæˆå†…å®¹ã€ç¼–å†™ä»£ç æˆ–æä¾›å»ºè®®ã€‚è¯·é—®æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©æ‚¨çš„å—ï¼Ÿ</p>
                </div>
            </div>
            <!-- æ­£åœ¨è¾“å…¥æç¤º -->
            <div id="typing" class="flex items-start gap-4 hidden max-w-3xl mx-auto animate-fade-in">
                <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-gemini-primary to-gemini-accent flex items-center justify-center flex-shrink-0 shadow-lg">
                    <i class="fa-solid fa-robot text-gemini-bg text-sm"></i>
                </div>
                <div class="assistant-message rounded-gemini rounded-tl-sm p-4">
                    <div class="flex items-center gap-1.5">
                        <div class="w-2 h-2 rounded-full typing-dot"></div>
                        <div class="w-2 h-2 rounded-full typing-dot"></div>
                        <div class="w-2 h-2 rounded-full typing-dot"></div>
                        <span class="text-text-muted text-sm ml-2">æ­£åœ¨æ€è€ƒ...</span>
                    </div>
                </div>
            </div>
        </div>
        <!-- è¾“å…¥åŒºåŸŸ - Gemini é£æ ¼ -->
        <div class="p-4 bg-gemini-bg/80 glass-effect border-t border-border-color/30">
            <div class="max-w-3xl mx-auto">
                <div class="glass-card rounded-gemini-lg overflow-hidden gradient-border">
                    <!-- è¾“å…¥æ¡† -->
                    <div class="p-4">
                        <div class="flex items-end gap-3">
                            <div class="flex-1 relative">
                                <textarea
                                    id="userInput"
                                    placeholder="è¾“å…¥æ‚¨çš„é—®é¢˜... (Shift + Enter æ¢è¡Œ)"
                                    class="w-full bg-transparent outline-none text-text-primary py-2 text-base resize-none scrollbar-thin placeholder:text-text-muted"
                                    rows="1"
                                ></textarea>
                            </div>
                            <button id="sendMessage" class="btn-primary p-3 rounded-xl flex-shrink-0">
                                <i class="fa-solid fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                    <!-- åº•éƒ¨å·¥å…·æ  -->
                    <div class="px-4 py-2 border-t border-border-color/30 flex items-center justify-between text-xs text-text-muted">
                        <div class="flex items-center gap-4">
                            <button class="flex items-center gap-1.5 hover:text-text-primary transition-colors">
                                <i class="fa-solid fa-image"></i>
                                <span class="hidden sm:inline">å›¾ç‰‡</span>
                            </button>
                            <button class="flex items-center gap-1.5 hover:text-text-primary transition-colors">
                                <i class="fa-solid fa-code"></i>
                                <span class="hidden sm:inline">ä»£ç </span>
                            </button>
                        </div>
                        <div class="flex items-center gap-3">
                            <span class="hidden sm:inline">æ”¯æŒ Markdown</span>
                            <span>â€¢</span>
                            <span>å†…å®¹ç”±AIç”Ÿæˆï¼Œä»…ä¾›å‚è€ƒ</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>
<script>
    // å®Œæ•´çš„æ¨¡å‹é…ç½®
    const DEFAULT_API_KEYS = {
        'deepseek-chat': 'sk-e345d5497c8643eb861f157be125c2ea',
        'deepseek-reasoner': 'sk-e345d5497c8643eb861f157be125c2ea',
        'qwen3-8b': 'sk-irbnwtggaoickmqdtbvefujcuahyduddochynjysaxyxkxcl',
        'glm-z1-9b-0414': 'sk-irbnwtggaoickmqdtbvefujcuahyduddochynjysaxyxkxcl',
        'glm-4-9b-chat': 'sk-irbnwtggaoickmqdtbvefujcuahyduddochynjysaxyxkxcl',
        'glm-4-9b-0414': 'sk-irbnwtggaoickmqdtbvefujcuahyduddochynjysaxyxkxcl',
        'internlm2_5-7b-chat': 'sk-irbnwtggaoickmqdtbvefujcuahyduddochynjysaxyxkxcl',
        'qwen2.5-7b-instruct': 'sk-irbnwtggaoickmqdtbvefujcuahyduddochynjysaxyxkxcl',
        'qwen2.5-coder-7b-instruct': 'sk-irbnwtggaoickmqdtbvefujcuahyduddochynjysaxyxkxcl',
        'qwen2-7b-instruct': 'sk-irbnwtggaoickmqdtbvefujcuahyduddochynjysaxyxkxcl'
    };
    const modelConfigurations = {
        'deepseek-chat': {
            apiUrl: 'https://api.deepseek.com/v1/chat/completions',
            modelName: 'deepseek-chat',
            displayName: 'DeepSeek Chat',
            type: 'chat',
            provider: 'DeepSeek'
        },
        'deepseek-reasoner': {
            apiUrl: 'https://api.deepseek.com/v1/chat/completions',
            modelName: 'deepseek-reasoner',
            displayName: 'DeepSeek Reasoner',
            type: 'reasoner',
            provider: 'DeepSeek'
        },
        'qwen3-8b': {
            apiUrl: 'https://api.siliconflow.cn/v1/chat/completions',
            modelName: 'Qwen/Qwen3-8B',
            displayName: 'Qwen3-8B',
            type: 'chat',
            provider: 'SiliconFlow'
        },
        'glm-z1-9b-0414': {
            apiUrl: 'https://api.siliconflow.cn/v1/chat/completions',
            modelName: 'THUDM/GLM-Z1-9B-0414',
            displayName: 'GLM-Z1-9B',
            type: 'reasoner',
            provider: 'SiliconFlow'
        },
        'glm-4-9b-chat': {
            apiUrl: 'https://api.siliconflow.cn/v1/chat/completions',
            modelName: 'THUDM/glm-4-9b-chat',
            displayName: 'GLM-4-9B-Chat',
            type: 'chat',
            provider: 'SiliconFlow'
        },
        'glm-4-9b-0414': {
            apiUrl: 'https://api.siliconflow.cn/v1/chat/completions',
            modelName: 'THUDM/GLM-4-9B-0414',
            displayName: 'GLM-4-9B-0414',
            type: 'chat',
            provider: 'SiliconFlow'
        },
        'internlm2_5-7b-chat': {
            apiUrl: 'https://api.siliconflow.cn/v1/chat/completions',
            modelName: 'internlm/internlm2_5-7b-chat',
            displayName: 'InternLM2.5-7B-Chat',
            type: 'chat',
            provider: 'SiliconFlow'
        },
        'qwen2.5-7b-instruct': {
            apiUrl: 'https://api.siliconflow.cn/v1/chat/completions',
            modelName: 'Qwen/Qwen2.5-7B-Instruct',
            displayName: 'Qwen2.5-7B-Instruct',
            type: 'chat',
            provider: 'SiliconFlow'
        },
        'qwen2.5-coder-7b-instruct': {
            apiUrl: 'https://api.siliconflow.cn/v1/chat/completions',
            modelName: 'Qwen/Qwen2.5-Coder-7B-Instruct',
            displayName: 'Qwen2.5-Coder-7B',
            type: 'coder',
            provider: 'SiliconFlow'
        },
        'qwen2-7b-instruct': {
            apiUrl: 'https://api.siliconflow.cn/v1/chat/completions',
            modelName: 'Qwen/Qwen2-7B-Instruct',
            displayName: 'Qwen2-7B-Instruct',
            type: 'chat',
            provider: 'SiliconFlow'
        }
    };

    // --- ä¿®å¤ 4.1: ç»Ÿä¸€ DOM å…ƒç´ ç®¡ç† ---
    const el = {
        // ä¾§è¾¹æ 
        sidebar: document.getElementById('sidebar'),
        sidebarOverlay: document.getElementById('sidebarOverlay'),
        mainContent: document.querySelector('main'),
        toggleSidebarBtn: document.getElementById('desktopSidebarToggle'), // æ³¨æ„: ID æ˜¯ desktopSidebarToggle
        historyList: document.getElementById('historyList'),
        newChatBtn: document.getElementById('newChatButton'),
        userMenuBtn: document.getElementById('userMenuTrigger'),
        usernameDisplay: document.getElementById('usernameDisplay'),

        // èŠå¤©åŒºåŸŸ
        welcomeScreen: document.querySelector('#chatBox > .max-w-3xl.mb-8'), // é€‰æ‹©æ¬¢è¿å±å¹•å®¹å™¨
        messagesList: document.getElementById('chatBox'), // æ¶ˆæ¯åˆ—è¡¨å°±æ˜¯ chatBox
        loadingIndicator: document.getElementById('typing'),
        userInput: document.getElementById('userInput'),
        sendBtn: document.getElementById('sendMessage'),
        modelSelect: document.getElementById('modelSelect'),

        // æ¨¡æ€æ¡†
        cookieModal: document.getElementById('cookieModal'),
        authModal: document.getElementById('authModal'),
        apiModal: document.getElementById('apiSettingsModal'),
        userMenuModal: document.getElementById('userMenuDropdown'),
        deleteModal: document.getElementById('deleteAccountModal'),

        // å…¶ä»–å…ƒç´ 
        mobileMenuButton: document.getElementById('mobileMenuButton'),
        emailInput: document.getElementById('emailInput'),
        passwordInput: document.getElementById('passwordInput'),
        authErrorMsg: document.getElementById('authErrorMsg'),
        authModalTitle: document.getElementById('authModalTitle'),
        authModalSubtitle: document.getElementById('authModalSubtitle'),
        submitAuthBtn: document.getElementById('submitAuth'),
        toggleAuthModeBtn: document.getElementById('toggleAuthMode'),
        togglePasswordBtn: document.getElementById('togglePassword'),
        apiKeyInput: document.getElementById('apiKeyInput'),
        apiKeyStatus: document.getElementById('apiKeyStatus'),
        openApiSettingsBtn: document.getElementById('openApiSettings'),
        closeApiSettingsBtn: document.getElementById('closeApiSettings'),
        apiModelSelect: document.getElementById('apiModelSelect'),
        toggleApiKeyBtn: document.getElementById('toggleApiKey'),
        saveApiKeyBtn: document.getElementById('saveApiKey'),
        resetApiKeyBtn: document.getElementById('resetApiKey'),
        modelStatus: document.getElementById('modelStatus'),
        logoutButton: document.getElementById('logoutButton'),
        deleteAccountButton: document.getElementById('deleteAccountButton'),
        acceptCookiesBtn: document.getElementById('acceptCookies'),
        declineCookiesBtn: document.getElementById('declineCookies'),
        toggleApiKeyVisibilityBtn: document.getElementById('toggleApiKey')
    };

    // åº”ç”¨çŠ¶æ€
    const appState = {
        isLoggedIn: false,
        authMode: 'login',
        isCookieConsent: false,
        currentChatId: null,
        messages: [],
        chatHistory: [],
        apiKeys: { ...DEFAULT_API_KEYS }
    };

    // --- ä¿®å¤ 1.1: æ”¹è¿› KaTeX é…ç½® ---
    function renderMathInMessage(element) {
        if (typeof renderMathInElement !== 'undefined') {
            // ä½¿ç”¨ requestAnimationFrame ç¡®ä¿ DOM æ›´æ–°åå†æ¸²æŸ“
            requestAnimationFrame(() => {
                try {
                    renderMathInElement(element, {
                        delimiters: [
                            {left: '$$', right: '$$', display: true}, // å—çº§å…¬å¼
                            {left: '$', right: '$', display: false}    // è¡Œå†…å…¬å¼
                        ],
                        throwOnError: false,  // ä¸æŠ›å‡ºé”™è¯¯
                        trust: true,          // ä¿¡ä»»å†…å®¹
                        strict: false         // ä¸ä½¿ç”¨ä¸¥æ ¼æ¨¡å¼
                    });
                } catch (e) {
                    console.error('Math rendering error:', e);
                }
            });
        }
    }

    // --- ä¿®å¤ 2.1 & 2.2: ä»£ç å¤åˆ¶æ ¼å¼ä¿ç•™ ---
    // ä¿®æ”¹å¢å¼ºçš„Markdownæ¸²æŸ“å‡½æ•°ä»¥ä½¿ç”¨Base64ç¼–ç 
    function enhancedMarkdownRender(text) {
        try {
            let html = text;

            // ä»£ç å— - ä¿ç•™åŸå§‹æ ¼å¼
            html = html.replace(/```(\w+)?
([\s\S]*?)```/g, function(match, lang, code) {
                const language = lang || 'plaintext';
                const id = 'code-' + Math.random().toString(36).substr(2, 9);

                // å…³é”®ï¼šä½¿ç”¨ Base64 ç¼–ç ä¿å­˜åŸå§‹ä»£ç 
                const encodedCode;
                try {
                    // ä½¿ç”¨ encodeURIComponent å¤„ç†ç‰¹æ®Šå­—ç¬¦ï¼Œç„¶å base64 ç¼–ç 
                    encodedCode = btoa(encodeURIComponent(code));
                } catch (e) {
                    // å¦‚æœç¼–ç å¤±è´¥ï¼Œåˆ™å°è¯•ç›´æ¥ç¼–ç æˆ–è®°å½•é”™è¯¯
                    console.warn("Failed to encode code block for copying:", e);
                    encodedCode = btoa(code); // å°è¯•ä¸å¸¦ encodeURIComponent çš„ç¼–ç 
                }

                // ä¸è½¬ä¹‰ä»£ç å†…å®¹ï¼Œä¿ç•™åŸå§‹æ ¼å¼ï¼Œä½†éœ€è¦è½¬ä¹‰å±æ€§å€¼
                return `<pre id="${id}" data-code="${encodedCode}"><div class="language-label">${language}</div><code class="language-${language}">${code}</code><button class="copy-button" title="å¤åˆ¶ä»£ç "><i class="fas fa-copy"></i> å¤åˆ¶</button></pre>`;
            });

            // æ ‡é¢˜
            html = html.replace(/^### (.*$)/gm, '<h3 class="text-lg font-semibold text-text-primary mt-4 mb-2">$1</h3>');
            html = html.replace(/^## (.*$)/gm, '<h2 class="text-xl font-semibold text-text-primary mt-5 mb-3">$1</h2>');
            html = html.replace(/^# (.*$)/gm, '<h1 class="text-2xl font-bold text-text-primary mt-6 mb-4 pb-2 border-b border-border-color">$1</h1>');

            // è¡Œå†…ä»£ç 
            html = html.replace(/`([^`]+)`/g, '<code class="bg-card-bg px-1.5 py-0.5 rounded text-sm text-gemini-accent">$1</code>');

            // ç²—ä½“å’Œæ–œä½“
            html = html.replace(/\*\*\*(.*?)\*\*\*/g, '<strong><em>$1</em></strong>');
            html = html.replace(/\*\*(.*?)\*\*/g, '<strong class="font-semibold text-text-primary">$1</strong>');
            html = html.replace(/\*(.*?)\*/g, '<em class="italic">$1</em>');

            // é“¾æ¥
            html = html.replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2" class="text-gemini-primary hover:text-gemini-accent underline transition-colors" target="_blank" rel="noopener noreferrer">$1</a>');

            // å¼•ç”¨å—
            html = html.replace(/^> (.*$)/gm, '<blockquote class="border-l-4 border-gemini-primary pl-4 py-2 my-3 bg-gemini-primary/5 rounded-r-lg italic text-text-secondary">$1</blockquote>');

            // æ— åºåˆ—è¡¨
            html = html.replace(/^- (.*$)/gm, '<li class="ml-4 mb-1 list-disc">$1</li>');
            html = html.replace(/^(\* )(.*$)/gm, '<li class="ml-4 mb-1 list-disc">$2</li>');

            // æœ‰åºåˆ—è¡¨
            html = html.replace(/^\d+\. (.*$)/gm, '<li class="ml-4 mb-1 list-decimal">$1</li>');

            // åˆ†éš”çº¿
            html = html.replace(/^---$/gm, '<hr class="my-6 border-border-color">');

            // è¡¨æ ¼ (ç®€åŒ–æ­£åˆ™ï¼Œå‡è®¾æ ¼å¼æ­£ç¡®)
            // æ³¨æ„ï¼šè¿™ä¸ªæ­£åˆ™æ¯”è¾ƒè„†å¼±ï¼Œé€‚ç”¨äºç®€å•çš„è¡¨æ ¼
            html = html.replace(/\n\|(.*?)\|\n\|[-:\| ]+\|\n([\s\S]*?)\n(?=\n|$)/g, function(match, headerRow, bodyRows) {
                const headers = headerRow.split('|').map(h => h.trim()).filter(h => h !== '');
                let headerHtml = '<thead><tr>';
                headers.forEach(header => {
                    headerHtml += `<th class="px-4 py-2 bg-gemini-primary/20 text-text-primary font-semibold">${header}</th>`;
                });
                headerHtml += '</tr></thead>';

                let bodyHtml = '<tbody>';
                const rows = bodyRows.split('\n');
                rows.forEach(row => {
                    row = row.trim();
                    if (row.startsWith('|') && row.endsWith('|')) {
                        const cells = row.slice(1, -1).split('|').map(c => c.trim());
                        bodyHtml += '<tr>';
                        cells.forEach(cell => {
                             bodyHtml += `<td class="px-4 py-2 border-b border-border-color/30">${cell}</td>`;
                        });
                        bodyHtml += '</tr>';
                    }
                });
                bodyHtml += '</tbody>';

                return `<table class="w-full border-collapse my-4 rounded-lg overflow-hidden">${headerHtml}${bodyHtml}</table>`;
            });

            // æ®µè½å¤„ç†
            html = html.replace(/<\/p>
<p class="mb-3 leading-relaxed">/g, '</p><p class="mb-3 leading-relaxed">'); // ä¿®æ­£è¿ç»­æ®µè½é—´çš„æ¢è¡Œç¬¦å¤„ç†
            html = html.replace(                /(?:^|
)([^
]*)/gm,
                function(match, p1) {
                    if (p1.trim() === '') return match; // ä¿æŒç©ºè¡Œ
                    // æ£€æŸ¥æ˜¯å¦æ˜¯åˆ—è¡¨é¡¹æˆ–æ ‡é¢˜ç­‰ï¼Œé¿å…é‡å¤åŒ…è£…
                    if (p1.match(/^<h[1-6]|^<ul|^<ol|^<li|^<blockquote|^<pre|^<table|^<hr/)) {
                        return p1;
                    }
                    return `<p class="mb-3 leading-relaxed text-text-secondary">${p1}</p>`;
                }
            );

            return html;
        } catch (error) {
            console.error("Error in enhancedMarkdownRender:", error);
            // å‘ç”Ÿé”™è¯¯æ—¶è¿”å›åŸå§‹æ–‡æœ¬çš„ç®€å•è½¬ä¹‰ç‰ˆæœ¬
            return escapeHtml(text);
        }
    }

    // ç®€å•çš„HTMLè½¬ä¹‰è¾…åŠ©å‡½æ•°
    function escapeHtml(html) {
        const div = document.createElement('div');
        div.textContent = html;
        return div.innerHTML;
    }


    // --- ä¿®å¤ 2.2: ä» Base64 è§£ç è¿˜åŸåŸå§‹æ ¼å¼ ---
    window.copyCode = function(id) {
        const pre = document.getElementById(id);
        if (!pre) {
            console.error(`Code block with id ${id} not found.`);
            return;
        }
        const encodedCode = pre.getAttribute('data-code');
        let code;

        if (encodedCode) {
            try {
                // ä» Base64 è§£ç ï¼Œå®Œæ•´è¿˜åŸåŸå§‹ä»£ç 
                code = decodeURIComponent(atob(encodedCode));
            } catch (e) {
                console.warn("Failed to decode code using Base64, trying fallback:", e);
                // é™çº§æ–¹æ¡ˆï¼šç›´æ¥è·å–æ–‡æœ¬å†…å®¹
                code = pre.querySelector('code')?.textContent || '';
            }
        } else {
            // å¦‚æœæ²¡æœ‰æ‰¾åˆ° data-code å±æ€§ï¼Œä¹Ÿä½¿ç”¨é™çº§æ–¹æ¡ˆ
             code = pre.querySelector('code')?.textContent || '';
        }

        // å¤åˆ¶åˆ°å‰ªè´´æ¿
        navigator.clipboard.writeText(code).then(() => {
            const btn = pre.querySelector('.copy-button');
            if (btn) {
                const originalHtml = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-check"></i> å·²å¤åˆ¶';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.innerHTML = originalHtml;
                    btn.classList.remove('copied');
                }, 2000);
            }
        }).catch(err => {
            console.error('Copy failed:', err);
            alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©å¤åˆ¶ã€‚');
        });
    };

    // --- ä¿®å¤ 3.1: åˆå§‹åŒ–æ—¶æ£€æµ‹è®¾å¤‡ ---
    function init() {
        console.log(`
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘      ğŸ¤– CrodEV - æ™ºèƒ½èŠå¤©åŠ©æ‰‹      â•‘
â•‘         Happy to see you! :)          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    `);

        loadStoredData();

        // ç›‘å¬ä¾§è¾¹æ æŠ˜å æŒ‰é’®
        document.querySelector('#sidebar .sidebar-toggle').addEventListener('click', toggleSidebar);
        el.toggleSidebarBtn.addEventListener('click', toggleSidebar);

        // ç›‘å¬ç§»åŠ¨ç«¯èœå•æŒ‰é’®
        el.mobileMenuButton.addEventListener('click', toggleMobileMenu);

        // ç›‘å¬æ–°å¯¹è¯æŒ‰é’®
        el.newChatBtn.addEventListener('click', startNewChat);

        // ç›‘å¬å‘é€æŒ‰é’®
        el.sendBtn.addEventListener('click', handleSendMessage);
        el.userInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                handleSendMessage();
            }
        });

        // ç›‘å¬æ¨¡å‹é€‰æ‹©
        el.modelSelect.addEventListener('change', updateModelStatus);

        // ç›‘å¬ç”¨æˆ·èœå•
        el.userMenuBtn.addEventListener('click', toggleUserMenu);

        // ç›‘å¬ç™»å‡ºæŒ‰é’®
        el.logoutButton.addEventListener('click', logout);

        // ç›‘å¬æ³¨é”€è´¦æˆ·æŒ‰é’®
        el.deleteAccountButton.addEventListener('click', () => {
            showElement(el.deleteModal);
            hideStep('deleteStep2');
            hideStep('deleteStep3');
            hideStep('deleteSuccess');
            showStep('deleteStep1');
        });

        // ç›‘å¬APIè®¾ç½®æŒ‰é’®
        el.openApiSettingsBtn.addEventListener('click', () => {
            showElement(el.apiModal);
            populateApiSettingsModal();
        });
        el.closeApiSettingsBtn.addEventListener('click', () => hideElement(el.apiModal));

        // ç›‘å¬APIè®¾ç½®ä¿å­˜å’Œé‡ç½®
        el.saveApiKeyBtn.addEventListener('click', saveApiKey);
        el.resetApiKeyBtn.addEventListener('click', resetApiKey);

        // ç›‘å¬APIå¯†é’¥æ˜¾ç¤º/éšè—
        el.toggleApiKeyBtn.addEventListener('click', () => {
            const input = el.apiKeyInput;
            const icon = el.toggleApiKeyBtn.querySelector('i');
            if (input.type === 'password') {
                input.type = 'text';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            } else {
                input.type = 'password';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            }
        });

        // ç›‘å¬å¯†ç æ˜¾ç¤º/éšè—
        el.togglePasswordBtn.addEventListener('click', () => {
            const input = el.passwordInput;
            const icon = el.togglePasswordBtn.querySelector('i');
            if (input.type === 'password') {
                input.type = 'text';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            } else {
                input.type = 'password';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            }
        });

        // æ³¨é”€ç¡®è®¤æ¨¡æ€æ¡†äº‹ä»¶
        document.getElementById('deleteStep1Continue').addEventListener('click', () => {
            hideStep('deleteStep1');
            showStep('deleteStep2');
        });
        document.getElementById('deleteStep2Continue').addEventListener('click', () => {
            hideStep('deleteStep2');
            showStep('deleteStep3');
        });
        document.getElementById('deleteStep3Confirm').addEventListener('click', performAccountDeletion);
        document.getElementById('deleteSuccessClose').addEventListener('click', () => {
            hideElement(el.deleteModal);
            logout(); // æ³¨é”€æˆåŠŸåæ‰§è¡Œç™»å‡ºæµç¨‹
        });

        // æ³¨é”€ç¡®è®¤æ¨¡æ€æ¡†å–æ¶ˆäº‹ä»¶
        document.getElementById('deleteStep1Cancel').addEventListener('click', () => hideElement(el.deleteModal));
        document.getElementById('deleteStep2Cancel').addEventListener('click', () => {
            hideStep('deleteStep2');
            showStep('deleteStep1');
        });
        document.getElementById('deleteStep3Cancel').addEventListener('click', () => {
            hideStep('deleteStep3');
            showStep('deleteStep2');
        });

        // CookieåŒæ„äº‹ä»¶
        el.acceptCookiesBtn.addEventListener('click', () => {
            appState.isCookieConsent = true;
            localStorage.setItem('cookieConsent', 'true');
            hideElement(el.cookieModal);
        });
        el.declineCookiesBtn.addEventListener('click', () => {
            appState.isCookieConsent = false;
            localStorage.setItem('cookieConsent', 'false');
            hideElement(el.cookieModal);
        });

        // è®¤è¯æ¨¡æ€æ¡†äº‹ä»¶
        el.submitAuthBtn.addEventListener('click', handleAuthSubmit);
        el.toggleAuthModeBtn.addEventListener('click', toggleAuthMode);

        // ä¾§è¾¹æ è¦†ç›–å±‚ç‚¹å‡»å…³é—­
        el.sidebarOverlay.addEventListener('click', toggleMobileMenu);

        // KaTeX åŠ è½½å®Œæˆåæ¸²æŸ“é¡µé¢ä¸Šçš„å…¬å¼
        if (typeof renderMathInElement !== 'undefined') {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false}
                ],
                throwOnError: false,
                trust: true,
                strict: false
            });
        }

        // --- ä¿®å¤ 3.1: åˆå§‹åŒ–æ—¶æ£€æµ‹è®¾å¤‡ ---
        if (window.innerWidth < 768) {
            el.sidebar.classList.add('hidden');
            el.mobileMenuButton.style.display = 'block'; // æ˜¾ç¤ºç§»åŠ¨ç«¯æŒ‰é’®
        } else {
            el.mobileMenuButton.style.display = 'none'; // éšè—ç§»åŠ¨ç«¯æŒ‰é’®
        }

        checkAuthStatus();
        updateModelStatus();
        loadChatHistory();
    }

    // --- ä¿®å¤ 3.2: çª—å£å¤§å°æ”¹å˜ç›‘å¬ ---
    window.addEventListener('resize', () => {
        if (window.innerWidth >= 768) {
            // æ¡Œé¢ç«¯
            el.sidebar.classList.remove('hidden');
            el.sidebarOverlay.classList.remove('active');
            el.mainContent.classList.remove('expanded');
            el.mobileMenuButton.style.display = 'none'; // éšè—ç§»åŠ¨ç«¯æŒ‰é’®
        } else {
            // ç§»åŠ¨ç«¯
            // å¦‚æœä¾§è¾¹æ å½“å‰æ˜¯å±•å¼€çš„ï¼ˆå³ä¸æ˜¯ hidden çŠ¶æ€ï¼‰ï¼Œåˆ™å°†å…¶éšè—ï¼Œå¹¶æ¿€æ´» overlay
            if (!el.sidebar.classList.contains('hidden')) {
                 el.sidebar.classList.add('hidden');
                 el.sidebarOverlay.classList.remove('active');
            }
            el.mobileMenuButton.style.display = 'block'; // æ˜¾ç¤ºç§»åŠ¨ç«¯æŒ‰é’®
        }
    });

    function toggleMobileMenu() {
        const isHidden = el.sidebar.classList.contains('hidden');
        if (isHidden) {
            el.sidebar.classList.remove('hidden');
            el.sidebarOverlay.classList.add('active');
        } else {
            el.sidebar.classList.add('hidden');
            el.sidebarOverlay.classList.remove('active');
        }
    }

    function addMessageToUI(content, isUser, thinking = null) {
        const messageDiv = document.createElement('div');
        messageDiv.className = `flex items-start gap-4 mb-6 max-w-3xl mx-auto animate-fade-in`;

        const avatarDiv = document.createElement('div');
        avatarDiv.className = `w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 shadow-lg`;
        const contentDiv = document.createElement('div');
        contentDiv.className = `message-bubble max-w-[85%] p-4`;

        if (isUser) {
            avatarDiv.className += ' bg-gradient-to-br from-gemini-accent to-gemini-primary text-gemini-bg';
            avatarDiv.innerHTML = '<i class="fa-solid fa-user text-sm"></i>';
            contentDiv.className += ' user-message';
        } else {
            avatarDiv.className += ' bg-gradient-to-br from-gemini-primary to-gemini-accent text-gemini-bg';
            avatarDiv.innerHTML = '<i class="fa-solid fa-robot text-sm"></i>';
            contentDiv.className += ' assistant-message';
        }

        // å¦‚æœæœ‰thinkingå†…å®¹ï¼Œå…ˆæ¸²æŸ“å®ƒ
        if (thinking) {
            const thinkTag = document.createElement('div');
            thinkTag.className = 'think-tag';
            thinkTag.innerHTML = `
                <div class="think-tag-header">
                    <i class="fa-solid fa-brain"></i>
                    <span>æ·±åº¦æ€è€ƒ</span>
                </div>
                <div class="think-tag-content markdown-content">
                    ${enhancedMarkdownRender(thinking)}
                </div>
            `;
            contentDiv.appendChild(thinkTag);

            // æ¸²æŸ“æ€è€ƒéƒ¨åˆ†çš„æ•°å­¦å…¬å¼å’Œé«˜äº®
            renderMathInMessage(thinkTag);
            hljs.highlightAll();
        }

        // æ¸²æŸ“ä¸»è¦å†…å®¹
        contentDiv.innerHTML += enhancedMarkdownRender(content);

        messageDiv.appendChild(avatarDiv);
        messageDiv.appendChild(contentDiv);

        // æ·»åŠ åˆ°DOM
        el.messagesList.appendChild(messageDiv);

        // --- ä¿®å¤ 1.2: åœ¨æ¶ˆæ¯æ·»åŠ åæ¸²æŸ“å…¬å¼ ---
        if (!isUser && typeof renderMathInElement !== 'undefined') {
            requestAnimationFrame(() => { // ç¡®ä¿ DOM æ›´æ–°å®Œæˆ
                try {
                    renderMathInElement(messageDiv, {
                        delimiters: [
                            {left: '$$', right: '$$', display: true},
                            {left: '$', right: '$', display: false}
                        ],
                        throwOnError: false,
                        trust: true,
                        strict: false
                    });
                } catch (e) {
                    console.error('Math rendering error after adding message:', e);
                }
            });
        }

        // é«˜äº®ä»£ç å—
        hljs.highlightAll();

        // æ·»åŠ å¤åˆ¶æŒ‰é’®äº‹ä»¶
        const copyButtons = messageDiv.querySelectorAll('.copy-button');
        copyButtons.forEach(button => {
            button.addEventListener('click', (e) => {
                e.stopPropagation(); // é˜²æ­¢ç‚¹å‡»å†’æ³¡åˆ°æ¶ˆæ¯æ°”æ³¡ä¸Š
                const pre = button.closest('pre');
                if (pre) {
                    window.copyCode(pre.id);
                }
            });
        });

        // æ»šåŠ¨åˆ°åº•éƒ¨
        scrollToBottom();
    }

    async function sendMessage(content) {
        if (!appState.isLoggedIn) {
            showElement(el.authModal);
            return;
        }

        if (!content.trim()) return;

        const currentModel = el.modelSelect.value;
        const config = modelConfigurations[currentModel];
        if (!config) {
            alert('æ— æ•ˆçš„æ¨¡å‹é€‰æ‹©');
            return;
        }

        const apiKey = appState.apiKeys[currentModel] || DEFAULT_API_KEYS[currentModel];

        if (!apiKey) {
            alert(`è¯·ä¸ºæ¨¡å‹ "${config.displayName}" è®¾ç½® API Key`);
            showElement(el.apiModal);
            populateApiSettingsModal(currentModel);
            return;
        }

        // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯åˆ°UI
        addMessageToUI(content, true);
        el.userInput.value = '';

        // æ˜¾ç¤ºåŠ è½½æŒ‡ç¤ºå™¨
        showElement(el.loadingIndicator);

        try {
            const response = await fetch(config.apiUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiKey}`
                },
                body: JSON.stringify({
                    model: config.modelName,
                    messages: [{ role: 'user', content: content }],
                    stream: true
                })
            });

            if (!response.ok) {
                throw new Error(`APIè¯·æ±‚å¤±è´¥: ${response.status} ${response.statusText}`);
            }

            const reader = response.body.getReader();
            const decoder = new TextDecoder();
            let content = '';
            let thinkingContent = null; // ç”¨äºå­˜å‚¨thinkingéƒ¨åˆ†

            while (true) {
                const { done, value } = await reader.read();
                if (done) break;

                const chunk = decoder.decode(value, { stream: true });
                const lines = chunk.split('\n');

                for (const line of lines) {
                    if (line.startsWith('data: ')) {
                        const dataStr = line.slice(6);
                        if (dataStr === '[DONE]') continue;

                        try {
                            const data = JSON.parse(dataStr);
                            if (data.choices && data.choices.length > 0) {
                                const choice = data.choices[0];
                                if (choice.delta) {
                                    const delta = choice.delta;

                                    // å¤„ç† thinking å­—æ®µ
                                    if (delta.thought) {
                                        if (!thinkingContent) {
                                            thinkingContent = delta.thought;
                                        } else {
                                            thinkingContent += delta.thought;
                                        }
                                    }

                                    // å¤„ç† content å­—æ®µ
                                    if (delta.content) {
                                        content += delta.content;

                                        // æ›´æ–°UI - åœ¨æµå¼æ›´æ–°æ—¶é‡æ–°æ¸²æŸ“æ•´ä¸ªæ¶ˆæ¯å†…å®¹
                                        // éœ€è¦ç§»é™¤ä¹‹å‰çš„ä¸´æ—¶æ¶ˆæ¯ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
                                        const existingTempMessage = document.querySelector('#chatBox > .flex:last-child:not(#typing)');
                                        if (existingTempMessage && existingTempMessage.querySelector('.assistant-message')) {
                                             existingTempMessage.remove();
                                        }

                                        const tempMessageDiv = document.createElement('div');
                                        tempMessageDiv.className = `flex items-start gap-4 mb-6 max-w-3xl mx-auto animate-fade-in`;

                                        const avatarDiv = document.createElement('div');
                                        avatarDiv.className = `w-10 h-10 rounded-xl bg-gradient-to-br from-gemini-primary to-gemini-accent flex items-center justify-center flex-shrink-0 shadow-lg text-gemini-bg`;
                                        avatarDiv.innerHTML = '<i class="fa-solid fa-robot text-sm"></i>';

                                        const contentDiv = document.createElement('div');
                                        contentDiv.className = `assistant-message message-bubble max-w-[85%] p-4`;

                                        // å¦‚æœæœ‰thinkingå†…å®¹ï¼Œå…ˆæ¸²æŸ“å®ƒ
                                        if (thinkingContent) {
                                            const thinkTag = document.createElement('div');
                                            thinkTag.className = 'think-tag';
                                            thinkTag.innerHTML = `
                                                <div class="think-tag-header">
                                                    <i class="fa-solid fa-brain"></i>
                                                    <span>æ·±åº¦æ€è€ƒ</span>
                                                </div>
                                                <div class="think-tag-content markdown-content">
                                                    ${enhancedMarkdownRender(thinkingContent)}
                                                </div>
                                            `;
                                            contentDiv.appendChild(thinkTag);

                                            // æ¸²æŸ“æ€è€ƒéƒ¨åˆ†çš„æ•°å­¦å…¬å¼å’Œé«˜äº®
                                            renderMathInMessage(thinkTag);
                                            hljs.highlightAll();
                                        }

                                        // æ¸²æŸ“ä¸»è¦å†…å®¹
                                        contentDiv.innerHTML += enhancedMarkdownRender(content);

                                        tempMessageDiv.appendChild(avatarDiv);
                                        tempMessageDiv.appendChild(contentDiv);

                                        // æ·»åŠ åˆ°DOM
                                        el.messagesList.appendChild(tempMessageDiv);

                                        // --- ä¿®å¤ 1.3: æµå¼å“åº”å®æ—¶æ¸²æŸ“ ---
                                        if (typeof renderMathInElement !== 'undefined') {
                                            requestAnimationFrame(() => {
                                                try {
                                                    renderMathInElement(tempMessageDiv, {
                                                        delimiters: [
                                                            {left: '$$', right: '$$', display: true},
                                                            {left: '$', right: '$', display: false}
                                                        ],
                                                        throwOnError: false,
                                                        trust: true,
                                                        strict: false
                                                    });
                                                } catch (e) {
                                                    console.error('Math error during streaming:', e);
                                                }
                                            });
                                        }

                                        // é«˜äº®ä»£ç å—
                                        hljs.highlightAll();

                                        // æ·»åŠ å¤åˆ¶æŒ‰é’®äº‹ä»¶ (å¯¹äºæ–°æ·»åŠ çš„ä»£ç å—)
                                        const newCopyButtons = tempMessageDiv.querySelectorAll('.copy-button:not([data-listener="true"])');
                                        newCopyButtons.forEach(button => {
                                            button.addEventListener('click', (e) => {
                                                e.stopPropagation();
                                                const pre = button.closest('pre');
                                                if (pre) {
                                                    window.copyCode(pre.id);
                                                }
                                            });
                                            button.setAttribute('data-listener', 'true'); // æ ‡è®°å·²æ·»åŠ ç›‘å¬å™¨
                                        });

                                        scrollToBottom();
                                    }
                                }
                            }
                        } catch (e) {
                            // å¿½ç•¥è§£æé”™è¯¯ï¼Œç»§ç»­å¤„ç†ä¸‹ä¸€è¡Œ
                            console.debug("Stream parsing error (likely [DONE] or malformed line):", e.message);
                        }
                    }
                }
            }

            // æ¶ˆæ¯æ¥æ”¶å®Œæ¯•ï¼Œéšè—åŠ è½½æŒ‡ç¤ºå™¨
            hideElement(el.loadingIndicator);

            // ä¿å­˜åˆ°ä¼šè¯å†å² (è¿™é‡Œå¯ä»¥ä¼˜åŒ–ä¸ºåªä¿å­˜æœ€ç»ˆç»“æœ)
            // appState.messages.push({role: 'user', content: content});
            // appState.messages.push({role: 'assistant', content: finalContent});

        } catch (error) {
            console.error('å‘é€æ¶ˆæ¯æ—¶å‡ºé”™:', error);
            hideElement(el.loadingIndicator);
            addMessageToUI(`å‘é€æ¶ˆæ¯æ—¶å‡ºç°é”™è¯¯: ${error.message}`, false);
        }
    }

    function handleSendMessage() {
        const content = el.userInput.value.trim();
        if (content) {
            sendMessage(content);
        }
    }

    function scrollToBottom() {
        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
        // æˆ–è€…é’ˆå¯¹èŠå¤©å®¹å™¨æ»šåŠ¨
        // const chatBox = document.getElementById('chatBox');
        // chatBox.scrollTop = chatBox.scrollHeight;
    }

    function toggleSidebar() {
        el.sidebar.classList.toggle('collapsed');
        const isCollapsed = el.sidebar.classList.contains('collapsed');
        const toggleIcon = document.querySelector('#sidebar .sidebar-toggle i');
        if (isCollapsed) {
            toggleIcon.classList.remove('fa-angle-left');
            toggleIcon.classList.add('fa-angle-right');
            el.toggleSidebarBtn.innerHTML = '<i class="fa-solid fa-chevron-right"></i> æ˜¾ç¤ºèœå•';
        } else {
            toggleIcon.classList.remove('fa-angle-right');
            toggleIcon.classList.add('fa-angle-left');
            el.toggleSidebarBtn.innerHTML = '<i class="fa-solid fa-chevron-left"></i> éšè—èœå•';
        }
    }

    function toggleUserMenu() {
        el.userMenuModal.classList.toggle('opacity-0');
        el.userMenuModal.classList.toggle('pointer-events-none');
    }

    function showElement(element) {
        element.classList.remove('opacity-0', 'pointer-events-none');
        element.classList.add('opacity-100', 'pointer-events-auto');
    }

    function hideElement(element) {
        element.classList.remove('opacity-100', 'pointer-events-auto');
        element.classList.add('opacity-0', 'pointer-events-none');
    }

    function showStep(stepId) {
        document.getElementById(stepId).classList.remove('hidden');
    }

    function hideStep(stepId) {
        document.getElementById(stepId).classList.add('hidden');
    }

    function populateApiSettingsModal(selectedModel = null) {
        if (selectedModel) {
            el.apiModelSelect.value = selectedModel;
        }
        const currentModel = el.apiModelSelect.value;
        const savedKey = appState.apiKeys[currentModel];
        el.apiKeyInput.value = savedKey || '';
        // Reset status message
        el.apiKeyStatus.classList.add('hidden');
        el.apiKeyStatus.textContent = '';
    }

    el.apiModelSelect.addEventListener('change', populateApiSettingsModal);

    function saveApiKey() {
        const model = el.apiModelSelect.value;
        const key = el.apiKeyInput.value.trim();

        if (!key) {
            el.apiKeyStatus.textContent = 'API Key ä¸èƒ½ä¸ºç©º';
            el.apiKeyStatus.classList.remove('text-success', 'hidden');
            el.apiKeyStatus.classList.add('text-danger');
            return;
        }

        appState.apiKeys[model] = key;
        localStorage.setItem('apiKeys', JSON.stringify(appState.apiKeys));

        el.apiKeyStatus.textContent = 'API Key ä¿å­˜æˆåŠŸï¼';
        el.apiKeyStatus.classList.remove('text-danger', 'hidden');
        el.apiKeyStatus.classList.add('text-success');

        // Clear status after 3 seconds
        setTimeout(() => {
            if (el.apiKeyStatus.textContent === 'API Key ä¿å­˜æˆåŠŸï¼') {
                el.apiKeyStatus.classList.add('hidden');
            }
        }, 3000);
    }

    function resetApiKey() {
        const model = el.apiModelSelect.value;
        const defaultKey = DEFAULT_API_KEYS[model];

        if (defaultKey) {
            appState.apiKeys[model] = defaultKey;
            localStorage.setItem('apiKeys', JSON.stringify(appState.apiKeys));
            el.apiKeyInput.value = defaultKey;
            el.apiKeyStatus.textContent = 'å·²æ¢å¤é»˜è®¤ API Key';
            el.apiKeyStatus.classList.remove('text-danger', 'hidden');
            el.apiKeyStatus.classList.add('text-success');
        } else {
            delete appState.apiKeys[model];
            localStorage.setItem('apiKeys', JSON.stringify(appState.apiKeys));
            el.apiInput.value = '';
            el.apiKeyStatus.textContent = 'å·²æ¸…é™¤è‡ªå®šä¹‰ API Key';
            el.apiKeyStatus.classList.remove('text-danger', 'hidden');
            el.apiKeyStatus.classList.add('text-success');
        }

         // Clear status after 3 seconds
         setTimeout(() => {
            el.apiKeyStatus.classList.add('hidden');
        }, 3000);
    }

    function loadStoredData() {
        const storedConsent = localStorage.getItem('cookieConsent');
        if (storedConsent === 'true') {
            appState.isCookieConsent = true;
        } else if (storedConsent === 'false') {
            appState.isCookieConsent = false;
        } else {
            // First time visitor, show cookie modal
            appState.isCookieConsent = null;
        }

        const storedApiKeyData = localStorage.getItem('apiKeys');
        if (storedApiKeyData) {
            try {
                appState.apiKeys = { ...DEFAULT_API_KEYS, ...JSON.parse(storedApiKeyData) };
            } catch (e) {
                console.error('Failed to parse stored API keys, using defaults:', e);
                appState.apiKeys = { ...DEFAULT_API_KEYS };
            }
        }
    }

    function checkAuthStatus() {
        const token = localStorage.getItem('token');
        const username = localStorage.getItem('username');
        if (token && username) {
            appState.isLoggedIn = true;
            el.usernameDisplay.textContent = username;
            if (!appState.isCookieConsent) {
                showElement(el.cookieModal);
            }
        } else {
            appState.isLoggedIn = false;
            showElement(el.authModal);
            if (!appState.isCookieConsent) {
                showElement(el.cookieModal);
            }
        }
    }

    function handleAuthSubmit() {
        const email = el.emailInput.value;
        const password = el.passwordInput.value;

        if (!email || !password) {
            showError('è¯·è¾“å…¥é‚®ç®±å’Œå¯†ç ');
            return;
        }

        // è¿™é‡Œåº”è¯¥è°ƒç”¨å®é™…çš„ç™»å½•/æ³¨å†ŒAPI
        // æ¨¡æ‹Ÿè®¤è¯æˆåŠŸ
        simulateAuth(email, password);
    }

    function simulateAuth(email, password) {
        // æ¨¡æ‹ŸAPIè°ƒç”¨å»¶è¿Ÿ
        setTimeout(() => {
            if (appState.authMode === 'login') {
                // æ¨¡æ‹Ÿç™»å½•æˆåŠŸ
                if (password.length >= 6) { // ç®€å•æ¨¡æ‹Ÿ
                    localStorage.setItem('token', 'fake-jwt-token');
                    localStorage.setItem('username', email.split('@')[0]);
                    appState.isLoggedIn = true;
                    appState.username = email.split('@')[0];
                    el.usernameDisplay.textContent = appState.username;
                    hideElement(el.authModal);
                    el.authErrorMsg.classList.add('hidden');
                    el.emailInput.value = '';
                    el.passwordInput.value = '';
                } else {
                    showError('ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•');
                }
            } else {
                // æ¨¡æ‹Ÿæ³¨å†ŒæˆåŠŸ
                if (password.length >= 6) {
                    localStorage.setItem('token', 'fake-jwt-token');
                    localStorage.setItem('username', email.split('@')[0]);
                    appState.isLoggedIn = true;
                    appState.username = email.split('@')[0];
                    el.usernameDisplay.textContent = appState.username;
                    hideElement(el.authModal);
                    el.authErrorMsg.classList.add('hidden');
                    el.emailInput.value = '';
                    el.passwordInput.value = '';
                } else {
                     showError('å¯†ç é•¿åº¦è‡³å°‘ä¸º6ä½');
                }
            }
        }, 800);
    }

    function showError(message) {
        el.authErrorMsg.textContent = message;
        el.authErrorMsg.classList.remove('hidden');
    }

    function toggleAuthMode() {
        appState.authMode = appState.authMode === 'login' ? 'register' : 'login';
        if (appState.authMode === 'login') {
            el.authModalTitle.textContent = 'ç™»å½• CrodEV';
            el.authModalSubtitle.textContent = 'è¯·è¾“å…¥æ‚¨çš„é‚®ç®±å’Œå¯†ç ä»¥ç»§ç»­';
            el.submitAuthBtn.innerHTML = '<i class="fa-solid fa-sign-in-alt mr-2"></i>ç™»å½•';
            el.toggleAuthModeBtn.textContent = 'è¿˜æ²¡æœ‰è´¦å·ï¼Ÿç«‹å³æ³¨å†Œ';
        } else {
            el.authModalTitle.textContent = 'æ³¨å†Œ CrodEV';
            el.authModalSubtitle.textContent = 'åˆ›å»ºæ–°è´¦æˆ·ä»¥å¼€å§‹ä½¿ç”¨';
            el.submitAuthBtn.innerHTML = '<i class="fa-solid fa-user-plus mr-2"></i>æ³¨å†Œ';
            el.toggleAuthModeBtn.textContent = 'å·²æœ‰è´¦å·ï¼Ÿç«‹å³ç™»å½•';
        }
        el.authErrorMsg.classList.add('hidden');
        el.emailInput.value = '';
        el.passwordInput.value = '';
    }

    function logout() {
        localStorage.removeItem('token');
        localStorage.removeItem('username');
        appState.isLoggedIn = false;
        appState.username = '';
        el.usernameDisplay.textContent = 'ç”¨æˆ·';
        showElement(el.authModal);
        hideElement(el.userMenuModal);
    }

    async function performAccountDeletion() {
        // è¿™é‡Œåº”è¯¥è°ƒç”¨å®é™…çš„æ³¨é”€API
        // æ¨¡æ‹Ÿæ³¨é”€è¿‡ç¨‹
        await new Promise(resolve => setTimeout(resolve, 1000)); // æ¨¡æ‹ŸAPIè¯·æ±‚

        // æ³¨é”€æˆåŠŸï¼Œæ¸…é™¤æœ¬åœ°æ•°æ®
        localStorage.removeItem('token');
        localStorage.removeItem('username');
        localStorage.removeItem('apiKeys');
        localStorage.removeItem('chatHistory');

        appState.isLoggedIn = false;
        appState.username = '';
        appState.apiKeys = { ...DEFAULT_API_KEYS };
        appState.chatHistory = [];

        el.usernameDisplay.textContent = 'ç”¨æˆ·';

        // æ˜¾ç¤ºæˆåŠŸä¿¡æ¯
        hideStep('deleteStep3');
        showStep('deleteSuccess');
    }

    function startNewChat() {
        // Clear current chat UI except welcome screen and first AI message
        const chatBox = el.messagesList;
        // Keep the first two elements (welcome screen and first AI msg) and the typing indicator
        const elementsToKeep = Array.from(chatBox.children).slice(0, 2);
        const typingElement = el.loadingIndicator;
        // Remove all other children
        while (chatBox.firstChild) {
            if (!elementsToKeep.includes(chatBox.firstChild) && chatBox.firstChild !== typingElement) {
                chatBox.removeChild(chatBox.firstChild);
            } else {
                // Move to the next sibling if it's one of the kept elements
                chatBox.firstChild = chatBox.firstChild.nextSibling;
            }
        }
        // Ensure typing indicator is hidden
        hideElement(el.loadingIndicator);

        // Reset any chat state variables if necessary
        // For example, if you track current conversation context:
        // appState.currentConversationId = generateNewId();
    }

    function updateModelStatus() {
        const selectedOption = el.modelSelect.selectedOptions[0];
        const optGroupLabel = selectedOption.parentElement.label;
        let statusText = 'å°±ç»ª';
        let statusColor = 'success';

        // Determine status based on optgroup or specific model
        if (optGroupLabel.includes('Reasoner')) {
            statusColor = 'warning';
            statusText = 'æ¨ç†ä¸­ âš¡';
        } else if (optGroupLabel.includes('Coder')) {
            statusColor = 'primary';
            statusText = 'ç¼–ç ä¸­ ğŸ’»';
        }

        el.modelStatus.innerHTML = `
            <span class="w-2 h-2 rounded-full bg-${statusColor} animate-pulse"></span>
            <span class="text-xs text-text-muted">${statusText}</span>
        `;
        // Re-add the success/warning class as innerHTML overwrites it
        el.modelStatus.querySelector('.bg-success, .bg-warning, .bg-primary').className = `w-2 h-2 rounded-full bg-${statusColor} animate-pulse`;
    }

    function loadChatHistory() {
        // Placeholder for loading chat history from storage/API
        // This would populate el.historyList
        console.log("Loading chat history...");
        // Example static item:
        // const item = document.createElement('li');
        // item.innerHTML = `<a href="#" class="flex items-center gap-3 px-4 py-2 rounded-xl text-text-secondary hover:bg-hover-bg hover:text-text-primary transition-all truncate"><i class="fa-solid fa-comment text-text-muted text-sm sidebar-icon"></i><span class="sidebar-text truncate">ä¸Šæ¬¡çš„å¯¹è¯</span></a>`;
        // el.historyList.appendChild(item);
    }

    // å¯åŠ¨åº”ç”¨
    document.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>

